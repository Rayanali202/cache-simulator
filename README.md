# Cache Simulator

Program starts by converting hex address to a 32 bit binary string. Starting from the right the first 6 bits are the offset bits for the 64B cache line. The next 9 bits represent the L1 cache index and the next 10 represent the L2 cache index. The remaining bits are the Tag bits.

![Image Alt Text](bits.png)

**Code Explanation**
The logic behind the cache simulator occurs in the 'simulate()' function in the Simulator class.

**Read:**
In the case of a read we start by checking the L1 cache at the L1_index for a tag match, this takes 0.5nsec. In the case of a miss, we go to the L2 cache at the L2_index and check for a tag match in the set. This takes 4.5nsec and in the case of a hit we incur a penalty of 5pj for moving the cache line into the L1 cache. If both L1 and L2 miss then we go to DRAM, which takes 45nsec. We check for an empty spot in the L2 cache in the set at L2_index. If no empty spot is found we choose a random cache line to replace. Moving data from DRAM to L2 or from L2 to DRAM (in the case of a dirty eviction) incurs a penalty of 640pj. Additionally, since we have an inclusive cache we have to make sure that the cache line we just evicted from L2 does not also currently exist in L1. In order to remedy this, we replace whatever is at L1_index with the new cache line brought in from DRAM and stored in L2. This takes a 5pj penalty for moving data from L2 to L1. 

**Write:**
Writes works pretty similar to reads with slight differences. We start by checking L1 for a tag match. If we get a hit this takes 5nsec (0.5nsec for L1 and 4.5 for L2) since we have to write through to L2. If we miss we go to L2. If we get a hit on the L2 cache then we write to L2 and move the updated cache line up to L1, we also mark the cache line as dirty and it takes 5nsec total. We also incur a 5pj penalty for moving data from L2 to L1. If both L1 and L2 miss we bring the cache line in from DRAM and replace a cache line in L2. We also update the respective cache line in L1 with the newly brought in cache line to maintain inclusivity. This takes no time according to specifications on Ed Discussion but we incur a penalty of 640pj for moving data between DRAM and L2 and 5pj for moving data between L2 and L1.

# Results 

**2 Set Associativity**

**4 Set Associativity**
File Name                 Avg Time    StdDev Time    Avg L1 Active (W)    StdDev L1 Active    Avg L1 Static (W)    StDev L1 Static    Avg L2 Active (W)    StdDev L2 Active    Avg L2 Static (W)    StDev L2 Static    Avg DRAM Active (W)    StdDev DRAM Active    Avg DRAM Static(W)    StDev DRAM Static    Avg Penalty (jP)    StdDev Penalty
----------------  ----------------  -------------  -------------------  ------------------  -------------------  -----------------  -------------------  ------------------  -------------------  -----------------  ---------------------  --------------------  --------------------  -------------------  ------------------  ----------------
008.ESPRESSO.DIN  798875                   0                    500000                   0               149438             0          561420                             0               414532             0                       79740                 0                    623152              0                    523595             0
013.SPICE2G6.DIN  872570                   0                    500001                   0               186284             0          687798                             0               422937             0                      120780                 0                    673900              0                    641710             0
015.DODUC.DIN     991672                  92.4797               500000                   0               245836            46.2399     879633                             0               441484            73.9838                 232794               370.351                746779              5.05964             1677635          1567.67
022.LI.DIN             1.00535e+06         0                    500002                   0               252673             0          968733                             0               416785             0                       99000                 0                    784478              0                    871150             0
023.EQNTOTT.DIN   866772                   0                    500000                   0               183386             0          722115                             0               404572             0                       49140                 0                    683590              0                   1027500             0
026.COMPRESS.DIN       1.21626e+06       832.303                500000                   0               358132           416.151           1.41242e+06                   0               408045           665.842                  133326              2978.38                 946346             73.5633              3901026         10693.1
034.MDLJDP2.DIN   826542                   0                    500000                   0               163271             0          590445                             0               425056             0                      138240                 0                    633586              0                    920735             0
039.WAVE5.DIN     739251                   0                    500000                   0               119626             0          440532                             0               415188             0                       81720                 0                    575057              0                    479695             0
047.TOMCATV.DIN        1.06129e+06       418.176                500000                   0               280644           209.088           1.1894e+06                    0               373269           334.541                   31914              1477.15                 842648             50.4293              5517579          7052.59
048.ORA.DIN       783326                   0                    500001                   0               141663             0          535761                             0               412357             0                       65340                 0                    613593              0                    349170             0
085.GCC.DIN       987734                 351.369                500000                   0               243867           175.684      879876                             0               438237           281.095                  216342              1356.19                 746919             18.8043              1685777          5414.21
089.SU2COR.DIN         1.04155e+06        60.6103               500000                   0               270776            30.3052          1.05992e+06                   0               409274            48.4883                  93690               212.132                814504              6.25389             1867205           603.398
090.HYDRO2D.DIN   968106                1396.03                 500000                   0               234053           698.013      833418                             0               441118          1116.82                   282942              4961.13                 717897            126.029               4070296         15793
093.NASA7.DIN     860880                   0                    500000                   0               180440             0          718929                             0               401132             0                       57240                 0                    677256              0                   1870490             0
094.FPPPP.DIN          1.01371e+06        71.494                500000                   0               256856            35.747      967572                             0               423941            57.1952                 147456               265.631                781479              9.84322             1479890          1739.68

**8 Set Associativity**
